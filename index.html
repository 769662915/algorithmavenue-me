<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>momenka</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="./vue.min.js"></script>
    <script src="./assets/common.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8223297477480525"
     crossorigin="anonymous"></script>
    <script>
        !function (w, d, t) {
            w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie","holdConsent","revokeConsent","grantConsent"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(
            var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var r="https://analytics.tiktok.com/i18n/pixel/events.js",o=n&&n.partner;ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=r,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};n=document.createElement("script")
            ;n.type="text/javascript",n.async=!0,n.src=r+"?sdkid="+e+"&lib="+t;e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(n,e)};
        
            ttq.load('D56IRE3C77U15BU5UR6G');
            ttq.page();
        }(window, document, 'ttq');
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .card-hover {
                @apply transition-all duration-500 hover:shadow-2xl hover:-translate-y-2;
            }
            .text-balance {
                text-wrap: balance;
            }
            .gradient-overlay {
                background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0) 70%);
            }
            .nav-item {
                @apply relative after:absolute after:bottom-0 after:left-0 after:h-0.5 after:w-0 after:bg-primary after:transition-all hover:after:w-full;
            }
        }
    </style>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-dark font-sans text-light antialiased selection:bg-primary selection:text-dark">
    <div id="app" class="flex h-screen overflow-hidden">
        
        <!-- 左侧固定导航栏 (Desktop) -->
        <aside class="hidden md:flex flex-col w-64 border-r border-gray-800 bg-black/50 backdrop-blur-md z-50">
            <div class="p-8 border-b border-gray-800">
                <h1 class="text-3xl font-display font-black tracking-tighter text-transparent bg-clip-text bg-gradient-to-r from-primary to-secondary cursor-pointer" @click="goHome()">
                    MOMENKA
                </h1>
                <p class="text-xs text-gray-500 mt-2 font-mono">NEURAL FEED v2.0</p>
            </div>

            <nav class="flex-1 overflow-y-auto p-6 space-y-2">
                <div class="mb-8">
                    <h3 class="text-xs font-mono text-gray-500 mb-4 uppercase tracking-widest">Modules</h3>
                    <a v-for="item in categories" :key="item.name" 
                       :href="'category.html?category=' + item.name" 
                       class="block py-2 px-4 -mx-4 text-sm font-bold uppercase tracking-wide text-gray-400 hover:text-primary hover:bg-white/5 transition-all border-l-2 border-transparent hover:border-primary">
                        {{ item.name }}
                    </a>
                </div>
                
                <div class="mt-auto">
                    <h3 class="text-xs font-mono text-gray-500 mb-4 uppercase tracking-widest">Trending</h3>
                    <div class="space-y-4">
                        <div v-for="(trend, index) in trendingNews.slice(0, 3)" :key="trend.id" class="group cursor-pointer" @click="toDetail(trend.id)">
                            <div class="flex items-start gap-3">
                                <span class="text-secondary font-mono text-xs">0{{ index + 1 }}</span>
                                <h4 class="text-xs font-medium text-gray-300 group-hover:text-primary transition-colors line-clamp-2 leading-relaxed">
                                    {{ trend.title }}
                                </h4>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>

            <div class="p-6 border-t border-gray-800">
                <button class="w-full flex items-center justify-between px-4 py-3 bg-white/5 border border-white/10 rounded text-gray-400 hover:text-primary hover:border-primary transition-all group" @click="toSearch()">
                    <span class="text-xs font-mono uppercase">Search Data</span>
                    <i class="fas fa-search group-hover:scale-110 transition-transform"></i>
                </button>
            </div>
        </aside>

        <!-- 移动端头部 -->
        <header class="md:hidden fixed top-0 left-0 right-0 h-16 bg-black/90 border-b border-gray-800 z-50 flex items-center justify-between px-4 backdrop-blur-md">
            <h1 class="text-xl font-display font-black tracking-tighter text-primary" @click="goHome()">MOMENKA</h1>
            <button class="text-white p-2" @click="toggleMenu">
                <i class="fas fa-bars text-lg"></i>
            </button>
        </header>

        <!-- 移动端全屏菜单 -->
        <div :class="['fixed inset-0 bg-black z-[60] flex flex-col p-8 transition-all duration-500', isMenuOpen ? 'opacity-100 translate-x-0' : 'opacity-0 translate-x-full pointer-events-none']">
            <div class="flex justify-between items-center mb-12">
                <span class="text-xs font-mono text-gray-500">SYSTEM MENU</span>
                <button @click="toggleMenu" class="text-primary text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <nav class="space-y-6">
                <a v-for="item in categories" :key="item.id" :href="'category.html?category=' + item.name" class="block text-3xl font-display font-bold text-white hover:text-primary uppercase">
                    {{ item.name }}
                </a>
            </nav>
            <div class="mt-auto">
                <button class="w-full py-4 border border-white/20 text-white font-mono uppercase hover:bg-primary hover:text-black hover:border-primary transition-colors" @click="toSearch()">
                    Search Database
                </button>
            </div>
        </div>

        <!-- 主内容区 -->
        <main class="flex-1 overflow-y-auto bg-dark scroll-smooth relative">
            <div class="container mx-auto max-w-7xl px-4 md:px-12 py-8 md:py-12 mt-16 md:mt-0">
                
                <!-- 顶部状态栏 (装饰性) -->
                <div class="flex justify-between items-end mb-12 border-b border-gray-800 pb-4 font-mono text-xs text-gray-500">
                    <div class="hidden md:block">
                        <span class="text-primary">●</span> ONLINE // SYSTEM READY
                    </div>
                    <div class="text-right">
                        {{ new Date().toLocaleDateString() }} <span class="mx-2">|</span> ID: GUEST_USER
                    </div>
                </div>

                <!-- Hero Section: Cyber Grid -->
                <section class="grid grid-cols-1 md:grid-cols-12 gap-4 mb-16" v-if="featuredNews">
                    <!-- Featured Large -->
                    <div class="md:col-span-8 relative group cursor-pointer overflow-hidden border border-white/10" @click="toDetail(featuredNews.id)">
                        <div class="aspect-[16/9] md:aspect-auto md:h-[500px] overflow-hidden">
                            <img :src="featuredNews.image_url" :alt="featuredNews.title" class="w-full h-full object-cover transition-all duration-700 grayscale group-hover:grayscale-0 group-hover:scale-105 opacity-80 group-hover:opacity-100">
                        </div>
                        <div class="absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent p-6 md:p-10 flex flex-col justify-end">
                            <div class="flex items-center gap-3 mb-4">
                                <span class="bg-primary text-black text-xs font-bold px-2 py-1 uppercase tracking-wider font-mono">{{ featuredNews.category }}</span>
                                <span class="text-gray-400 text-xs font-mono">{{ featuredNews.publish_date }}</span>
                            </div>
                            <h2 class="text-3xl md:text-5xl font-display font-bold text-white leading-tight mb-4 group-hover:text-primary transition-colors">
                                {{ featuredNews.title }}
                            </h2>
                            <p class="text-gray-300 max-w-2xl line-clamp-2 md:line-clamp-3 hidden md:block">
                                {{ featuredNews?.summary?.substring(0, 150) }}...
                            </p>
                        </div>
                    </div>
                    
                    <!-- Secondary Stack -->
                    <div class="md:col-span-4 flex flex-col gap-4">
                        <div v-for="(news, idx) in secondaryNews.slice(0, 2)" :key="news.id" 
                             class="relative flex-1 group cursor-pointer overflow-hidden border border-white/10"
                             @click="toDetail(news.id)">
                            <div class="absolute inset-0">
                                <img :src="news.image_url" :alt="news.title" class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500 opacity-60 group-hover:opacity-100">
                            </div>
                            <div class="absolute inset-0 bg-black/60 group-hover:bg-black/40 transition-colors p-6 flex flex-col justify-end">
                                <span class="text-primary text-xs font-mono mb-2 uppercase">{{ news.category }}</span>
                                <h3 class="text-lg font-bold text-white leading-tight group-hover:translate-x-1 transition-transform">
                                    {{ news.title }}
                                </h3>
                            </div>
                        </div>
                    </div>
                </section>

                <div class="ad-container mb-16 border-y border-gray-800 py-8 bg-white/5">
                    <span class="block text-center text-xs font-mono text-gray-600 mb-4 tracking-[0.2em]">SPONSORED CONTENT</span>
                    <ins class="adsbygoogle"
                            style="display:block"
                            data-ad-client="ca-pub-8223297477480525"
                            data-ad-slot="6016686309"
                            data-ad-format="auto"
                            data-full-width-responsive="true">
                    </ins>
                </div>

                <!-- Latest News: Grid Layout -->
                <section id="news-list-container">
                    <div class="flex items-center justify-between mb-10">
                        <h2 class="text-2xl font-display font-bold text-white uppercase tracking-tight flex items-center gap-3">
                            <span class="w-3 h-3 bg-primary"></span>
                            Latest Transmissions
                        </h2>
                        <div class="h-px bg-gray-800 flex-1 ml-6"></div>
                    </div>

                    <!-- Loading -->
                    <div v-if="loading" class="flex justify-center items-center h-64">
                        <div class="font-mono text-primary animate-pulse text-xl">LOADING DATA...</div>
                    </div>

                    <!-- Error -->
                    <div v-else-if="loadError" class="border border-red-900 bg-red-900/20 p-8 text-center">
                        <h3 class="text-red-500 font-mono mb-4">SYSTEM ERROR: {{ loadError }}</h3>
                        <button @click="getNewsList" class="px-6 py-2 border border-red-500 text-red-500 hover:bg-red-500 hover:text-black font-mono uppercase transition-colors">
                            Retry
                        </button>
                    </div>

                    <!-- Grid -->
                    <div v-else class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-16">
                        <div v-for="news in paginatedNews" :key="news.id" class="group bg-tertiary border border-white/5 hover:border-primary/50 transition-all duration-300 flex flex-col" @click="toDetail(news.id)">
                            <div class="relative aspect-[3/2] overflow-hidden">
                                <img :src="news.image_url" :alt="news.title" class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500">
                                <div class="absolute top-4 right-4 bg-black/80 text-white text-xs font-mono px-2 py-1">
                                    {{ news.publish_date }}
                                </div>
                            </div>
                            <div class="p-6 flex flex-col flex-1">
                                <span class="text-primary text-xs font-bold uppercase tracking-wider mb-3">{{ news.category }}</span>
                                <h3 class="text-xl font-bold text-white mb-4 leading-snug group-hover:text-primary transition-colors">
                                    {{ news.title }}
                                </h3>
                                <p class="text-gray-400 text-sm leading-relaxed line-clamp-3 mb-6 flex-1">
                                    {{ news?.summary?.substring(0, 150) }}...
                                </p>
                                <div class="mt-auto pt-4 border-t border-white/5 flex justify-between items-center text-xs font-mono text-gray-500 group-hover:text-white transition-colors">
                                    <span>READ MORE</span>
                                    <i class="fas fa-arrow-right transform -rotate-45 group-hover:rotate-0 transition-transform"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pagination (Minimalist) -->
                    <div class="flex justify-center items-center gap-2 font-mono" v-if="!loading && !loadError">
                        <button class="w-10 h-10 border border-gray-800 text-gray-500 hover:text-primary hover:border-primary disabled:opacity-30 disabled:hover:text-gray-500 disabled:hover:border-gray-800 transition-all"
                                :disabled="currentPage === 1" @click="currentPage--">
                            &lt;
                        </button>
                        
                        <div class="flex gap-2">
                            <button v-for="page in visiblePages" :key="page" 
                                    class="w-10 h-10 border transition-all"
                                    :class="page === currentPage ? 'bg-primary text-black border-primary font-bold' : 'border-gray-800 text-gray-500 hover:text-primary hover:border-primary'"
                                    @click="currentPage = page; scrollToNewsTop()">
                                {{ page }}
                            </button>
                        </div>

                        <button class="w-10 h-10 border border-gray-800 text-gray-500 hover:text-primary hover:border-primary disabled:opacity-30 disabled:hover:text-gray-500 disabled:hover:border-gray-800 transition-all"
                                :disabled="currentPage === totalPages" @click="currentPage++; scrollToNewsTop()">
                            &gt;
                        </button>
                    </div>
                </section>

                <footer class="mt-24 border-t border-gray-800 pt-12 pb-8 text-center md:text-left">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-12 mb-12">
                        <div class="md:col-span-2">
                            <h2 class="text-2xl font-display font-bold text-white mb-4">MOMENKA</h2>
                            <p class="text-gray-500 max-w-sm text-sm">
                                Decoding the noise. Delivering the signal. A next-generation news interface for the modern observer.
                            </p>
                        </div>
                        <div>
                            <h4 class="font-mono text-xs text-primary mb-6 uppercase tracking-widest">Navigation</h4>
                            <ul class="space-y-2 text-sm text-gray-400">
                                <li v-for="item in categories.slice(0, 5)" :key="item.id">
                                    <a :href="'category.html?category=' + item.name" class="hover:text-white transition-colors">{{ item.name }}</a>
                                </li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-mono text-xs text-primary mb-6 uppercase tracking-widest">Connect</h4>
                            <div class="flex gap-4">
                                <a href="#" class="w-10 h-10 border border-gray-700 flex items-center justify-center text-gray-400 hover:text-white hover:border-white transition-all rounded-full">
                                    <i class="fab fa-twitter"></i>
                                </a>
                                <a href="#" class="w-10 h-10 border border-gray-700 flex items-center justify-center text-gray-400 hover:text-white hover:border-white transition-all rounded-full">
                                    <i class="fab fa-instagram"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-600 font-mono border-t border-gray-800/50 pt-8 flex flex-col md:flex-row justify-between items-center">
                        <span>&copy; 2025 MOMENKA INC.</span>
                        <span class="mt-2 md:mt-0">DESIGNED BY TRAE</span>
                    </div>
                </footer>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var googleScript = document.createElement('script');
            googleScript.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6278654188550063';
            googleScript.crossOrigin = 'anonymous';
            googleScript.async = true;
            document.head.appendChild(googleScript);
        });
        
        new Vue({
            el: '#app',
            mixins: [AppMixin],
            data() {
                return {
                    // pageSize 已在 Mixin 中定义，这里可以覆盖或使用默认
                    featuredNews: null,
                    secondaryNews: [],
                    newsItems: [],
                    trendingNews: []
                }
            },
            mounted() {
                this.getNewsList()
                this.getCategories();

                setTimeout(function() {
                    if (typeof(adsbygoogle) !== 'undefined') {
                        adsbygoogle = window.adsbygoogle || [];
                        adsbygoogle.push({});
                    }
                }, 500);
            },
            computed: {
                paginatedNews() {
                    const startIndex = (this.currentPage - 1) * this.pageSize;
                    return this.newsItems.slice(startIndex, startIndex + this.pageSize);
                },
                totalPages() {
                    return Math.ceil(this.newsItems.length / this.pageSize);
                },
                visiblePages() {
                    // 始终显示当前页前后2个页码（共5个页码）
                    const pages = [];
                    let startPage = Math.max(1, this.currentPage - 2);
                    let endPage = Math.min(this.totalPages, this.currentPage + 2);
                    
                    // 确保始终显示至少5个页码（除非总页数少于5）
                    if (endPage - startPage < 4) {
                        if (startPage === 1) {
                            endPage = Math.min(5, this.totalPages);
                        } else if (endPage === this.totalPages) {
                            startPage = Math.max(1, this.totalPages - 4);
                        }
                    }
                    
                    for (let i = startPage; i <= endPage; i++) {
                        pages.push(i);
                    }
                    
                    return pages;
                }
            },
            methods: {
                getNewsList() {
                    this.loading = true;
                    this.loadError = null;
                    fetch('assets/articles.json')
                        .then(response => {
                            if (!response.ok) {
                            throw new Error('网络响应不正常');
                            }
                            return response.json();
                        })
                        .then(data => {
                            this.featuredNews  = data.slice(0, 1)[0]
                            this.secondaryNews = data.slice(1, 3)
                            this.newsItems = data.slice(3);
                            this.trendingNews = this.getUniqueRandomValues(data.slice(3 + this.pageSize), 4)
                            this.loading = false;
                        })
                        .catch(error => {
                            console.error('请求失败:', error);
                            this.loadError = error.message;
                            this.loading = false;
                        });
                },
                scrollToNewsTop() {
                    const newsContainer = document.getElementById('news-list-container');
                    if (newsContainer) {
                        newsContainer.scrollIntoView({ behavior: 'smooth' });
                    }
                }
                // 其他通用方法如 toDetail, getCategories, toggleMenu 等已包含在 Mixin 中
            }
        });
    </script>
    <!-- <script src="assets/adTracker.js"></script>
    <script src="assets/adDisplayTracker.js"></script> -->
</body>
</html>