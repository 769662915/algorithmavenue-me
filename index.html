<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>momenka</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="./vue.min.js"></script>
    <script src="./assets/common.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8223297477480525"
     crossorigin="anonymous"></script>
    <script>
        !function (w, d, t) {
            w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie","holdConsent","revokeConsent","grantConsent"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(
            var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var r="https://analytics.tiktok.com/i18n/pixel/events.js",o=n&&n.partner;ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=r,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};n=document.createElement("script")
            ;n.type="text/javascript",n.async=!0,n.src=r+"?sdkid="+e+"&lib="+t;e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(n,e)};
        
            ttq.load('D56IRE3C77U15BU5UR6G');
            ttq.page();
        }(window, document, 'ttq');
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .card-hover {
                @apply transition-all duration-500 hover:shadow-2xl hover:-translate-y-2;
            }
            .text-balance {
                text-wrap: balance;
            }
            .gradient-overlay {
                background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0) 70%);
            }
            .nav-item {
                @apply relative after:absolute after:bottom-0 after:left-0 after:h-0.5 after:w-0 after:bg-primary after:transition-all hover:after:w-full;
            }
        }
    </style>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-light font-sans text-dark">
    <div id="app">
        <header class="bg-white backdrop-blur-sm shadow-md sticky top-0 z-50">
            <div class="container mx-auto px-4">
                <div class="flex flex-row justify-between items-center py-5">
                    <h1 class="text-2xl font-bold text-primary" @click="goHome()">
                        <img src="./assets/logo.png" alt="Pixel Prose" class="h-8">
                    </h1>
                    
                    <div class="flex md:w-auto items-center justify-between">
                        <nav class="hidden md:flex space-x-8">
                            <a v-for="item in categories" :key="item.name" :href="'category.html?category=' + item.name" class="font-medium nav-item transition-colors">
                                {{ item.name }}
                            </a>
                        </nav>

                        <button class="md:hidden ml-4 text-dark hover:text-primary transition-colors" @click="toggleMenu">
                            <i class="fas fa-bars text-xl"></i>
                        </button>
                        
                        <button class="ml-10 text-dark hover:text-primary transition-colors" @click="toSearch()">
                            <i class="fas fa-search text-xl"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- 移动端侧边菜单（修改样式） -->
        <div :class="['fixed inset-0 bg-black bg-opacity-70 z-50 transition-opacity duration-500', isMenuOpen ? 'opacity-100' : 'opacity-0 pointer-events-none']" @click="toggleMenu"></div>
        <div :class="['fixed top-0 right-0 h-full w-72 bg-tertiary z-50 transform transition-transform duration-500', isMenuOpen ? 'translate-x-0' : 'translate-x-full']">
            <div class="p-5 border-b border-white/20 flex justify-between items-center">
                <h3 class="font-bold text-white text-xl">Menu</h3>
                <button @click="toggleMenu" class="text-white hover:text-primary">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <nav class="p-5">
                <ul class="space-y-5">
                    <li v-for="item in categories" :key="item.id">
                        <a :href="'category.html?category=' + item.name" class="block py-2 text-white hover:text-primary transition-colors text-lg">{{ item.name }}</a>
                    </li>
                </ul>
            </nav>
        </div>

        <div class="ad-container mb-5 mt-5">
            <span class="ad-label flex justify-center items-center mb-4">ADVERTISEMENT</span>
            <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-client="ca-pub-8223297477480525"
                    data-ad-slot="6016686309"
                    data-ad-format="auto"
                    data-full-width-responsive="true">
            </ins>
        </div>
        
        <!-- 头条新闻区（修改布局为垂直排列） -->
        <section class="container mx-auto px-4 py-8">
            <div class="space-y-6">
                <!-- 主要头条 -->
                <div class="relative rounded-xl overflow-hidden h-[500px] group card-hover" v-if="featuredNews" @click="toDetail(featuredNews.id)">
                    <img :src="featuredNews.image_url" :alt="featuredNews.title" class="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110">
                    <div class="absolute inset-0 gradient-overlay flex flex-col justify-end p-8">
                        <span class="inline-block px-4 py-1.5 bg-primary text-white text-sm font-semibold rounded-full mb-4 w-max transform transition-transform group-hover:scale-110">
                            {{ featuredNews.category }}
                        </span>
                        <h2 class="text-[clamp(1.8rem,5vw,3rem)] font-display font-bold text-white mb-3 leading-tight line-clamp-3">
                            {{ featuredNews.title }}
                        </h2>
                        <p class="text-gray-200 mb-5 max-w-3xl text-lg">
                            {{ featuredNews?.summary?.substring(0, 150) }}...
                        </p>
                        <div class="flex items-center text-gray-300">
                            <span class="text-lg">{{ featuredNews.publish_date }}</span>
                        </div>
                    </div>
                </div>
                
                <!-- 次要头条（改为水平排列） -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6" v-if="secondaryNews && secondaryNews[0]">
                    <div class="relative rounded-xl overflow-hidden h-[280px] group card-hover" @click="toDetail(secondaryNews[0].id)">
                        <img :src="secondaryNews[0].image_url" :alt="secondaryNews[0].title" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                        <div class="absolute inset-0 gradient-overlay flex flex-col justify-end p-6">
                            <span class="inline-block px-3 py-1 bg-secondary text-white text-xs font-semibold rounded-full mb-3 w-max">{{ secondaryNews[0].category }}</span>
                            <h3 class="text-xl font-display font-bold text-white leading-tight line-clamp-2">
                                {{ secondaryNews[0].title }}
                            </h3>
                        </div>
                    </div>
                    
                    <div class="relative rounded-xl overflow-hidden h-[280px] group card-hover" @click="toDetail(secondaryNews[1].id)">
                        <img :src="secondaryNews[1].image_url" :alt="secondaryNews[1].title" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                        <div class="absolute inset-0 gradient-overlay flex flex-col justify-end p-6">
                            <span class="inline-block px-3 py-1 bg-tertiary text-white text-xs font-semibold rounded-full mb-3 w-max">{{ secondaryNews[1].category }}</span>
                            <h3 class="text-xl font-display font-bold text-white leading-tight line-clamp-2">
                                {{ secondaryNews[1].title }}
                            </h3>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <main class="container mx-auto px-4 py-10">
            <!-- 交换侧边栏和主内容区的位置 -->
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-10">
                <!-- 侧边栏移到左边 -->
                <div class="lg:col-span-4 order-2 lg:order-1">
                    <!-- 热门新闻 -->
                    <div class="bg-white rounded-2xl shadow-lg p-6 mb-8 transform transition-transform hover:shadow-xl">
                        <h3 class="text-2xl font-display font-bold mb-6 flex items-center border-b border-gray-100 pb-3">
                            <i class="fas fa-fire text-primary mr-3"></i>
                            Trending News
                        </h3>
                        <div class="space-y-6">
                            <div v-for="(trend, index) in trendingNews" :key="trend.id" class="flex gap-4 group cursor-pointer" @click="toDetail(trend.id)">
                                <div class="font-display font-bold text-3xl text-gray-200 group-hover:text-primary transition-colors mt-1">
                                    {{ index + 1 }}
                                </div>
                                <div>
                                    <h4 class="font-medium group-hover:text-primary transition-colors line-clamp-2">
                                        {{ trend.title }}
                                    </h4>
                                    <p class="text-gray-500 text-sm mt-2">
                                        {{ trend.publish_date }}
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 主要新闻列表 -->
                <div class="lg:col-span-8 order-1 lg:order-2" id="news-list-container">
                    <h2 class="text-3xl font-display font-bold mb-8 flex items-center">
                        <span class="w-8 h-1 bg-primary mr-3 rounded-full"></span>
                        Latest News
                    </h2>
                    
                    <div class="min-h-[600px]">
                        <!-- 加载状态 -->
                        <div v-if="loading" class="flex justify-center items-center h-64">
                            <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"></div>
                        </div>

                        <!-- 错误状态 -->
                        <div v-else-if="loadError" class="bg-red-50 p-8 rounded-lg text-center">
                            <i class="fas fa-exclamation-circle text-4xl text-red-400 mb-4"></i>
                            <h3 class="text-xl font-bold text-gray-700 mb-2">数据加载失败</h3>
                            <p class="text-gray-500 mb-4">{{ loadError }}</p>
                            <button @click="getNewsList" class="px-4 py-2 bg-primary text-white rounded hover:bg-opacity-90 transition-colors">
                                重试
                            </button>
                        </div>

                        <div v-else class="space-y-8">
                            <!-- 新闻卡片改为垂直布局 -->
                            <div v-for="news in paginatedNews" :key="news.id" class="bg-white rounded-2xl overflow-hidden shadow-md card-hover" @click="toDetail(news.id)">
                                <img :src="news.image_url" :alt="news.title" class="w-full h-56 object-cover">
                                <div class="p-6">
                                    <div class="flex items-center mb-4">
                                        <span :class="news.categoryColor" class="text-xs font-semibold px-3 py-1 rounded-full text-white">
                                            {{ news.category }}
                                        </span>
                                        <span class="ml-auto text-gray-500 text-sm">
                                            {{ news.publish_date }}
                                        </span>
                                    </div>
                                    <h3 class="text-2xl font-display font-bold mb-3 hover:text-primary transition-colors cursor-pointer line-clamp-2">
                                        {{ news.title }}
                                    </h3>
                                    <p class="text-gray-600">
                                        {{ news?.summary?.substring(0, 200) }}...
                                    </p>
                                </div>
                            </div>
                            
                            <!-- 当内容不足时显示空白填充 -->
                            <div v-if="paginatedNews.length < pageSize" class="flex-grow"></div>
                        </div>
                    </div>
                    
                    <!-- 分页部分 -->
                    <div class="mt-12 flex justify-center" v-if="!loading && !loadError">
                        <nav class="inline-flex rounded-lg shadow-lg overflow-hidden">
                            <button class="px-5 py-3 bg-white border border-gray-200 text-sm font-medium text-gray-600 hover:bg-gray-50 transition-colors"
                                    :disabled="currentPage === 1" @click="currentPage--">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            
                            <!-- 首页 -->
                            <button v-if="currentPage > 3" 
                                    class="px-5 py-3 bg-white border-t border-b border-gray-200 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors"
                                    @click="currentPage = 1; scrollToNewsTop()">
                                1
                            </button>
                            
                            <!-- 前省略号 -->
                            <span v-if="currentPage > 4" class="px-5 py-3 bg-white border-t border-b border-gray-200 text-sm font-medium text-gray-500">
                                ...
                            </span>
                            
                            <!-- 中间页码 -->
                            <button v-for="page in visiblePages" :key="page" 
                                    class="px-5 py-3 bg-white border-t border-b border-gray-200 text-sm font-medium transition-colors"
                                    :class="page === currentPage ? 'text-primary border-primary bg-primary/5' : 'text-gray-700 hover:bg-gray-50'">
                                {{ page }}
                            </button>
                            
                            <!-- 后省略号 -->
                            <span v-if="currentPage < totalPages - 3" class="px-5 py-3 bg-white border-t border-b border-gray-200 text-sm font-medium text-gray-500">
                                ...
                            </span>
                            
                            <!-- 尾页 -->
                            <button v-if="currentPage < totalPages - 2" 
                                    class="px-5 py-3 bg-white border-t border-b border-gray-200 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors"
                                    @click="currentPage = totalPages; scrollToNewsTop()">
                                {{ totalPages }}
                            </button>
                            
                            <button class="px-5 py-3 bg-white border border-gray-200 text-sm font-medium text-gray-600 hover:bg-gray-50 transition-colors"
                                    :disabled="currentPage === totalPages" @click="currentPage++; scrollToNewsTop()">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </nav>
                    </div>
                </div>
            </div>
        </main>
        
        <footer class="bg-tertiary text-white pt-16 pb-8 mt-16">
            <div class="container mx-auto px-4">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-10 mb-12">
                    <div class="md:col-span-2">
                        <h3 class="text-2xl font-display font-bold mb-6">momenka</h3>
                        <p class="mb-6 text-gray-200 max-w-md">Your premier destination for comprehensive sports news, analysis, and updates from around the world.</p>
                    </div>
                    
                    <div>
                        <h4 class="text-xl font-semibold mb-5 border-b border-white/20 pb-2">Categories</h4>
                        <ul class="space-y-3">
                            <li v-for="item in categories" :key="item.id">
                                <a :href="'category.html?category=' + item.name" class="hover:text-primary transition-colors">{{ item.name }}</a>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="border-t border-white/10 pt-8 text-center text-gray-300">
                    <p>&copy; 2025 momenka. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var googleScript = document.createElement('script');
            googleScript.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6278654188550063';
            googleScript.crossOrigin = 'anonymous';
            googleScript.async = true;
            document.head.appendChild(googleScript);
        });
        
        new Vue({
            el: '#app',
            mixins: [AppMixin],
            data() {
                return {
                    // pageSize 已在 Mixin 中定义，这里可以覆盖或使用默认
                    featuredNews: null,
                    secondaryNews: [],
                    newsItems: [],
                    trendingNews: []
                }
            },
            mounted() {
                this.getNewsList()
                this.getCategories();

                setTimeout(function() {
                    if (typeof(adsbygoogle) !== 'undefined') {
                        adsbygoogle = window.adsbygoogle || [];
                        adsbygoogle.push({});
                    }
                }, 500);
            },
            computed: {
                paginatedNews() {
                    const startIndex = (this.currentPage - 1) * this.pageSize;
                    return this.newsItems.slice(startIndex, startIndex + this.pageSize);
                },
                totalPages() {
                    return Math.ceil(this.newsItems.length / this.pageSize);
                },
                visiblePages() {
                    // 始终显示当前页前后2个页码（共5个页码）
                    const pages = [];
                    let startPage = Math.max(1, this.currentPage - 2);
                    let endPage = Math.min(this.totalPages, this.currentPage + 2);
                    
                    // 确保始终显示至少5个页码（除非总页数少于5）
                    if (endPage - startPage < 4) {
                        if (startPage === 1) {
                            endPage = Math.min(5, this.totalPages);
                        } else if (endPage === this.totalPages) {
                            startPage = Math.max(1, this.totalPages - 4);
                        }
                    }
                    
                    for (let i = startPage; i <= endPage; i++) {
                        pages.push(i);
                    }
                    
                    return pages;
                }
            },
            methods: {
                getNewsList() {
                    this.loading = true;
                    this.loadError = null;
                    fetch('assets/articles.json')
                        .then(response => {
                            if (!response.ok) {
                            throw new Error('网络响应不正常');
                            }
                            return response.json();
                        })
                        .then(data => {
                            this.featuredNews  = data.slice(0, 1)[0]
                            this.secondaryNews = data.slice(1, 3)
                            this.newsItems = data.slice(3);
                            this.trendingNews = this.getUniqueRandomValues(data.slice(3 + this.pageSize), 4)
                            this.loading = false;
                        })
                        .catch(error => {
                            console.error('请求失败:', error);
                            this.loadError = error.message;
                            this.loading = false;
                        });
                },
                scrollToNewsTop() {
                    const newsContainer = document.getElementById('news-list-container');
                    if (newsContainer) {
                        newsContainer.scrollIntoView({ behavior: 'smooth' });
                    }
                }
                // 其他通用方法如 toDetail, getCategories, toggleMenu 等已包含在 Mixin 中
            }
        });
    </script>
    <!-- <script src="assets/adTracker.js"></script>
    <script src="assets/adDisplayTracker.js"></script> -->
</body>
</html>